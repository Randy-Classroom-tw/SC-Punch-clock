<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>SC_Office_ANN</title>
  <meta name="viewport" content="width=device-width, initial-scale=0.6, maximum-scale=1.0, user-scalable=no" />
  <meta name="gas-url" content="<?!= ScriptApp.getService().getUrl() ?>">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' https: data: blob:; img-src 'self' https: data: blob:; font-src 'self' https: data:; style-src 'self' 'unsafe-inline' https:; script-src 'self' 'unsafe-inline' 'unsafe-eval' https:; frame-ancestors 'self';">
  <meta http-equiv="X-Content-Type-Options" content="nosniff">
  <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
  <meta http-equiv="Permissions-Policy" content="geolocation=(), camera=(), microphone=()">
  
  <!-- é åŠ è¼‰è³‡æº -->
  <link rel="preload" href="https://fonts.googleapis.com/icon?family=Material+Icons" as="style">
  <link rel="preload" href="https://i.imgur.com/YHBBnuO.jpeg" as="image" crossorigin="anonymous">
  <link rel="preload" href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400&display=swap" as="style">
  
  <!-- jQuery UI Datetimepicker -->
  <link rel="stylesheet" href="https://code.jquery.com/ui/1.13.2/themes/dark-hive/jquery-ui.css">
  <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
  <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-ui-timepicker-addon/1.6.3/jquery-ui-timepicker-addon.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-ui-timepicker-addon/1.6.3/jquery-ui-timepicker-addon.min.css">
  
  <link rel="icon" type="image/png" sizes="32x32" href="https://i.imgur.com/YHBBnuO.jpeg">
  <link rel="apple-touch-icon" href="https://i.imgur.com/YHBBnuO.jpeg">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400&display=swap">
  
  <!-- ç¹é«”ä¸­æ–‡è¨­å®š -->
  <script>
    $(function() {
      $.datepicker.regional['zh-TW'] = {
        closeText: 'é—œé–‰',
        prevText: '&#x3C;ä¸Šæœˆ',
        nextText: 'ä¸‹æœˆ&#x3E;',
        currentText: 'ä»Šå¤©',
        monthNames: ['ä¸€æœˆ','äºŒæœˆ','ä¸‰æœˆ','å››æœˆ','äº”æœˆ','å…­æœˆ',
        'ä¸ƒæœˆ','å…«æœˆ','ä¹æœˆ','åæœˆ','åä¸€æœˆ','åäºŒæœˆ'],
        monthNamesShort: ['ä¸€æœˆ','äºŒæœˆ','ä¸‰æœˆ','å››æœˆ','äº”æœˆ','å…­æœˆ',
        'ä¸ƒæœˆ','å…«æœˆ','ä¹æœˆ','åæœˆ','åä¸€æœˆ','åäºŒæœˆ'],
        dayNames: ['æ˜ŸæœŸæ—¥','æ˜ŸæœŸä¸€','æ˜ŸæœŸäºŒ','æ˜ŸæœŸä¸‰','æ˜ŸæœŸå››','æ˜ŸæœŸäº”','æ˜ŸæœŸå…­'],
        dayNamesShort: ['é€±æ—¥','é€±ä¸€','é€±äºŒ','é€±ä¸‰','é€±å››','é€±äº”','é€±å…­'],
        dayNamesMin: ['æ—¥','ä¸€','äºŒ','ä¸‰','å››','äº”','å…­'],
        weekHeader: 'é€±',
        dateFormat: 'yy-mm-dd',
        firstDay: 1,
        isRTL: false,
        showMonthAfterYear: true,
        yearSuffix: 'å¹´'
      };
      $.datepicker.setDefaults($.datepicker.regional['zh-TW']);
      
      $.timepicker.regional['zh-TW'] = {
        timeOnlyTitle: 'äºŒåå››å°æ™‚åˆ¶',  // ä¿®æ”¹æ¨™é¡Œç‚ºã€ŒäºŒåå››å°æ™‚åˆ¶ã€
        timeText: 'æ™‚é–“',
        hourText: 'å°æ™‚',
        minuteText: 'åˆ†é˜',
        secondText: 'ç§’é˜',
        millisecText: 'æ¯«ç§’',
        microsecText: 'å¾®ç§’',
        timezoneText: 'æ™‚å€',
        currentText: 'ç¾åœ¨æ™‚é–“',
        closeText: 'é—œé–‰',
        timeFormat: 'HH:mm',
        amNames: ['ä¸Šåˆ', 'AM', 'A'],
        pmNames: ['ä¸‹åˆ', 'PM', 'P'],
        isRTL: false
      };
      $.timepicker.setDefaults($.timepicker.regional['zh-TW']);
    });
  </script>
</head>

  <style>
    :root {
      /* ä¸»é¡Œè‰²å½© */
      --color-bg-primary: #1a1a1a;
      --color-bg-secondary: rgba(20, 20, 20, 0.95);
      --color-bg-tertiary: rgba(40, 40, 40, 0.8);
      --color-text-primary: #e0e0e0;
      --color-text-secondary: #bbb;
      --color-text-success: #2ecc71;
      --color-text-error: #e74c3c;
      
      /* æŒ‰éˆ•é¡è‰² */
      --btn-on-from: #28a745;
      --btn-on-to: #1e7e34;
      --btn-off-from: #e74c3c;
      --btn-off-to: #c0392b;
      --btn-query-from: #3498db;
      --btn-query-to: #2980b9;
      --btn-test-from: #f39c12;
      --btn-test-to: #e67e22;
      --btn-form-from: #9c27b0;
      --btn-form-to: #673ab7;
      --btn-schedule-from: #e91e63;
      --btn-schedule-to: #c2185b;
      --btn-disabled-from: #666;
      --btn-disabled-to: #555;
      /* å…¬å‘ŠæŒ‰éˆ• */
      --btn-notice-from: #607d8b;
      --btn-notice-to: #455a64;
      /* ä¸»ç®¡é™å®š */
      --btn-manager-from: #795548;
      --btn-manager-to: #5d4037;
      /* å€‹äººè³‡è¨Š */
      --btn-personal-from: #00bcd4;
      --btn-personal-to: #0097a7;
      
      
      /* é–“è·è¨­å®š */
      --spacing-xs: 4px;
      --spacing-sm: 8px;
      --spacing-md: 16px;
      --spacing-lg: 20px;
      --spacing-xl: 30px;
      --border-radius-sm: 6px;
      --border-radius-md: 10px;
      --border-radius-lg: 12px;
    }
    
    input::-ms-reveal,
    input::-ms-clear { display: none !important; }
    input[type=password]::-webkit-textfield-decoration-container {
      visibility: hidden !important;
      pointer-events: none !important;
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html { font-size: 100%; }
    body {
      background: linear-gradient(145deg, #0a0a0a, var(--color-bg-primary));
      font-family: 'Roboto Mono', monospace;
      color: var(--color-text-primary);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
      font-weight: 700;
      text-shadow: 1px 1px 2px #000;
    }
    .container {
      background: var(--color-bg-secondary);
      border: 2px solid #333;
      border-radius: var(--border-radius-lg);
      box-shadow: 0 8px 20px rgba(0,0,0,0.8), inset 0 2px 4px rgba(255,255,255,0.05);
      padding: 40px;
      max-width: 700px;
      width: 100%;
      text-align: center;
    }
    .logo {
      width: 120px;
      margin: 0 auto 20px;
      filter: drop-shadow(0 4px 4px rgba(0,0,0,0.6));
    }
    h1 {
      font-size: 36px;
      letter-spacing: 2px;
      text-transform: uppercase;
      color: #fff;
      margin-bottom: 10px;
    }
    h2 {
      font-size: 20px;
      color: var(--color-text-secondary);
      margin-bottom: 30px;
    }
    form {
      background: var(--color-bg-tertiary);
      border: 1px solid #333;
      border-radius: var(--border-radius-md);
      padding: 20px;
      margin-bottom: 30px;
      box-shadow: inset 0 2px 8px rgba(0,0,0,0.7);
    }
    label {
      display: block;
      font-size: 18px;
      margin-bottom: 10px;
      color: #ccc;
    }
    .input-group {
      position: relative;
      margin-bottom: 8px;
    }
    input[type="password"],
    input[type="text"],
    input[type="tel"] {
      width: 100%;
      font-size: 20px;
      padding: 14px 50px 14px 16px;
      border: none;
      border-radius: var(--border-radius-sm);
      background-color: #222;
      color: #fff;
      text-align: center;
      box-shadow: inset 0 2px 4px rgba(0,0,0,0.8);
      transition: background 0.3s, box-shadow 0.3s;
    }
    input:focus {
      background-color: #333;
      box-shadow: 0 0 8px rgba(0,176,255,0.6), inset 0 2px 6px rgba(0,0,0,0.5);
    }
    .toggle-btn {
      position: absolute;
      right: 12px;
      top: 50%;
      transform: translateY(-50%);
      background: transparent;
      border: none;
      color: #aaa;
      font-size: 22px;
      cursor: pointer;
      transition: color 0.3s;
    }
    .toggle-btn:hover { color: #fff; }
    .btn-group {
      display: flex;
      flex-wrap: wrap;
      gap: var(--spacing-md);
      justify-content: center;
      margin-bottom: 20px;
      /* ç¢ºä¿åœ¨å°è¢å¹•ä¸Šä¹Ÿèƒ½æ­£å¸¸é¡¯ç¤º */
      align-items: center;
    }
    .btn {
      /* å›ºå®šå°ºå¯¸ç¢ºä¿ä¸€è‡´æ€§ */
      width: 150px;
      height: 50px;
      min-width: 150px;
      min-height: 50px;
      max-width: 150px;
      max-height: 50px;
      padding: 0;
      font-size: 17px;
      border: none;
      border-radius: var(--border-radius-md);
      cursor: pointer;
      box-shadow: 0 4px 8px rgba(0,0,0,0.6), inset 0 -2px 0 rgba(0,0,0,0.2);
      color: #fff;
      background-size: 100% 100%;
      transition: none;
      /* æ–‡å­—ç½®ä¸­ */
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      /* é˜²æ­¢æ–‡å­—æ›è¡Œ */
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .btn:hover { transform: translateY(-3px); }
    .btn:active { transform: translateY(0); }
    .btn:disabled {
      opacity: 0.7;
      cursor: not-allowed;
      transform: none;
      background: linear-gradient(to right, var(--btn-disabled-from), var(--btn-disabled-to));
    }
    .btn-on { background: linear-gradient(to right, var(--btn-on-from) 0%, var(--btn-on-to) 100%); }
    .btn-off { background: linear-gradient(to right, var(--btn-off-from) 0%, var(--btn-off-to) 100%); }
    .btn-query { background: linear-gradient(to right, var(--btn-query-from) 0%, var(--btn-query-to) 100%); }
    .btn-test { background: linear-gradient(to right, var(--btn-test-from) 0%, var(--btn-test-to) 100%); }
    .btn-form { background: linear-gradient(to right, var(--btn-form-from) 0%, var(--btn-form-to) 100%); }
    .btn-schedule { background: linear-gradient(to right, var(--btn-schedule-from) 0%, var(--btn-schedule-to) 100%); }
    /* æ–°æŒ‰éˆ•æ¨£å¼ */
    .btn-notice { background: linear-gradient(to right, var(--btn-notice-from) 0%, var(--btn-notice-to) 100%); }
    .btn-manager { background: linear-gradient(to right, var(--btn-manager-from) 0%, var(--btn-manager-to) 100%); }
    .btn-personal { background: linear-gradient(to right, var(--btn-personal-from) 0%, var(--btn-personal-to) 100%); }
    
    .ui-timepicker-div {
      background: #333;
      color: #fff;
      width: 280px;
      min-width: 280px;
      max-width: 320px;
      background-color: #222;
      padding: 15px;
      border-radius: 0;
      border: none;
      border-top: 1px solid #444;
      box-shadow: none;
    }

    /* ğŸ”§ ä¿®å¾©ï¼šå®Œå…¨éš±è— jQuery UI Timepicker çš„ grid é¡¯ç¤ºå…ƒç´  */
    .ui-timepicker-grid,
    .ui-timepicker-div .ui-timepicker-hour-label,
    .ui-timepicker-div .ui-timepicker-minute-label,
    .ui-timepicker-div .ui-widget-content,
    .ui-timepicker-div table.ui-timepicker-table,
    .ui-timepicker-div [class*="grid"],
    .ui-timepicker-div [class*="table"] {
      display: none !important;
      visibility: hidden !important;
    }

    #ui-datepicker-div {
      z-index: 10000 !important;
      background-color: #222 !important;
      padding: 0 !important;
      border: none !important;
      margin-top: 0 !important;
      box-shadow: 0 4px 12px rgba(0,0,0,0.5) !important;
      position: absolute !important;
      transform: none !important;
      margin-left: 0 !important;
      margin-right: 0 !important;
      width: 320px !important;
      min-width: 280px !important;
      max-width: 360px !important;
    }
    
    /* ç¢ºä¿æœˆä»½åˆ‡æ›æ™‚ä¿æŒä¸€è‡´æ€§ */
    #ui-datepicker-div .ui-datepicker {
      width: 100% !important;
      box-sizing: border-box !important;
    }
    
    /* ç¢ºä¿æ—¥æ›†è¡¨æ ¼ä½ˆå±€ç©©å®š */
    #ui-datepicker-div .ui-datepicker-calendar {
      width: 100% !important;
      table-layout: fixed !important;
    }

    .ui-timepicker-div dl {
      display: flex;
      flex-direction: row;
      justify-content: space-between;
      align-items: flex-start;
      margin: 0;
      padding: 0;
    }

    .ui-slider {
      display: none;
    }

    .ui-timepicker-div dd {
      margin: 0;
      padding: 0;
      width: 48%;
      text-align: center;
    }

    .ui-timepicker-div dd.ui_tpicker_hour:before {
      content: 'å°æ™‚';
      display: block;
      margin-bottom: 5px;
      color: #ccc;
      font-size: 14px;
      text-align: center;
    }

    .ui-timepicker-div dd.ui_tpicker_minute:before {
      content: 'åˆ†é˜';
      display: block;
      margin-bottom: 5px;
      color: #ccc;
      font-size: 14px;
      text-align: center;
    }

    .ui-timepicker-div select {
      width: 95%;
      margin: 0 auto;
      text-align: center;
      text-align-last: center;
      -moz-text-align-last: center;
      -webkit-text-align-last: center;
    }

    .ui-timepicker-div select option {
      text-align: center;
    }

    .ui-timepicker-div .timepicker-buttons {
      display: flex;
      justify-content: space-between;
      margin-top: 15px;
      padding-top: 15px;
      border-top: 1px solid #444;
    }

    .ui-timepicker-div .timepicker-button {
      background-color: #333;
      color: #fff;
      border: 1px solid #555;
      border-radius: 5px;
      padding: 8px 15px;
      font-size: 14px;
      cursor: pointer;
      transition: background-color 0.2s;
      min-width: 80px;
      text-align: center;
    }

    .ui-timepicker-div .timepicker-button.confirm {
      background-color: #2c7a3e;
      border-color: #1e5a2d;
    }

    .ui-timepicker-div .timepicker-button.cancel {
      background-color: #666;
      border-color: #555;
    }

    .ui-timepicker-div .timepicker-button:hover {
      opacity: 0.9;
    }
    
    @media (max-width: 480px) {
      .btn {
        width: 140px;
        height: 48px;
        min-width: 140px;
        min-height: 48px;
        max-width: 140px;
        max-height: 48px;
        font-size: 16px;
      }
    }
    
    @media (max-width: 360px) {
      .btn {
        width: 130px;
        height: 46px;
        min-width: 130px;
        min-height: 46px;
        max-width: 130px;
        max-height: 46px;
        font-size: 15px;
      }
      
      .btn-group {
        gap: 12px;
      }
    }
    
    #response {
      margin-top: 10px;
      font-size: 16px;
      background: rgba(0,0,0,0.4);
      border-radius: var(--border-radius-sm);
      padding: 10px;
      min-height: 40px;
      box-shadow: inset 0 1px 3px rgba(0,0,0,0.7);
      opacity: 0;
      transform: translateY(-10px);
      transition: opacity 0.5s ease, transform 0.5s ease;
      color: #76ff03;
      overflow-x: auto;
    }
    #response.show {
      opacity: 1;
      transform: translateY(0);
    }
    #response table {
      width: 100%;
      min-width: 400px;
      border-collapse: collapse;
      text-align: center;
      border: 1px solid #555;
      font-size: 14px;
    }
    #response th, #response td {
      padding: 4px;
      border: 1px solid #666;
      white-space: nowrap;
    }
    .loading {
      font-size: 16px;
      color: #ff4444;
      animation: blink 1s infinite;
    }
    .loading::before {
      content: "";
      display: inline-block;
      width: 18px;
      height: 18px;
      border: 3px solid #ccc;
      border-radius: 50%;
      border-top-color: #09f;
      animation: spin 0.8s infinite linear;
      vertical-align: middle;
      margin-right: 5px;
    }
    @keyframes spin { to { transform: rotate(360deg); } }
    @keyframes blink { 0% { opacity: 1; } 50% { opacity: 0.4; } 100% { opacity: 1; } }
    .overlay {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.75);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 9999;
    }
    .overlay.show { display: flex; }
    .modal {
      background: #222;
      padding: 24px;
      border-radius: var(--border-radius-md);
      width: 90%;
      max-width: 400px;
      color: #fff;
      text-align: center;
      box-shadow: 0 8px 20px rgba(0,0,0,0.8);
    }
    .modal h3 {
      font-size: 24px;
      margin-bottom: 12px;
      letter-spacing: 1px;
    }
    .modal p {
      font-size: 18px;
      margin-bottom: 20px;
    }
    .modal-buttons {
      display: flex;
      gap: 12px;
      justify-content: space-evenly;
    }
    .modal .btn {
      flex: 1;
      padding: 10px;
      border-radius: var(--border-radius-sm);
      font-size: 20px;
      font-family: 'Roboto Mono', monospace;
      cursor: pointer;
      transition: background 0.3s, transform 0.3s;
      box-shadow: none;
      border: none;
    }
    .btn-confirm { background: var(--btn-on-from); color: #fff; }
    .btn-cancel { background: var(--btn-off-from); color: #fff; }
    .btn-confirm:hover { background: var(--btn-on-to); }
    .btn-cancel:hover { background: var(--btn-off-to); }
    #incognitoPrompt {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.85);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 10000;
    }
    #incognitoPrompt .prompt-content {
      background: #222;
      border: 2px solid #444;
      border-radius: var(--border-radius-md);
      padding: 20px 30px;
      text-align: center;
      max-width: 450px;
      width: 90%;
    }
    #incognitoPrompt h2 {
      margin-bottom: 20px;
      color: #fff;
      font-size: 24px;
    }
    #incognitoPrompt p {
      margin-bottom: 20px;
      font-size: 18px;
      color: #ddd;
    }
    #incognitoPrompt .button-group {
      display: flex;
      gap: var(--spacing-md);
      justify-content: center;
    }
    #incognitoPrompt .button-group button {
      font-family: 'Roboto Mono', monospace;
      flex: 1;
      min-width: 120px;
      padding: 12px 20px;
      font-size: 16px;
      border: none;
      border-radius: var(--border-radius-sm);
      cursor: pointer;
      transition: background 0.3s;
    }
    #confirmIncognito { background-color: var(--btn-on-from); color: #fff; }
    #confirmIncognito:hover { background-color: var(--btn-on-to); }
    #cancelIncognito { background-color: var(--btn-off-from); color: #fff; }
    #cancelIncognito:hover { background-color: var(--btn-off-to); }
    #videoTutorialModal {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.85);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 11000;
      padding: 20px;
    }
    #videoTutorialModal .video-content {
      background: #222;
      border: 2px solid #444;
      border-radius: var(--border-radius-md);
      padding: 20px;
      text-align: center;
      max-width: 600px;
      width: 100%;
      position: relative;
    }
    #videoTutorialModal video {
      width: 100%;
      height: auto;
      border-radius: var(--border-radius-sm);
    }
    #videoTutorialModal .fallback-link {
      display: none;
      margin-top: 10px;
      color: #76ff03;
      font-size: 18px;
    }
    #videoTutorialModal .close-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      background: transparent;
      border: none;
      color: #fff;
      font-size: 24px;
      cursor: pointer;
    }
    .network-status {
      position: fixed;
      top: 10px;
      right: 10px;
      padding: 6px 12px;  /* çµ±ä¸€èˆ‡ AI Bot çš„ padding */
      border-radius: 20px;
      font-size: 14px;
      font-weight: bold;
      box-shadow: 0 2px 4px rgba(0,0,0,0.3);
      z-index: 999;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .network-status .material-icons {
      font-size: 18px;
    }
    .network-good { background-color: rgba(76, 175, 80, 0.9); color: #fff; }      /* è‰¯å¥½ - æ·±ç¶ è‰² */
    .network-online { background-color: rgba(40, 167, 69, 0.8); color: #fff; }
    .network-medium { background-color: rgba(255, 193, 7, 0.9); color: #fff; font-weight: 600; }  /* ä¸€èˆ¬ - é»ƒè‰²ï¼Œæ”¹ç”¨ç™½è‰²æ–‡å­— */
    .network-poor { background-color: rgba(255, 152, 0, 0.9); color: #fff; }      /* ç·©æ…¢ - æ©˜è‰² */
    .network-offline { background-color: rgba(220, 53, 69, 0.8); color: #fff; }   /* é›¢ç·š - ç´…è‰² */
    
    .help-status {
      position: fixed;
      top: 10px;
      right: 110px;
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 16px;
      font-weight: bold;
      box-shadow: 0 2px 4px rgba(0,0,0,0.3);
      z-index: 999;
      transition: all 0.3s ease;
      background-color: rgba(52, 152, 219, 0.8);
    }
    
    .help-status a {
      color: #fff;
      text-decoration: none;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    
    .help-status .material-icons {
      font-size: 18px;
    }
    
    .help-status:hover {
      background-color: rgba(52, 152, 219, 1);
      transform: translateY(-1px);
    }
    .error-message {
      position: absolute;
      top: 100%;
      left: 50%;
      transform: translateX(-50%);
      color: red;
      font-size: 14px;
      display: none;
      margin-top: 5px;
      opacity: 0;
      transition: opacity 0.5s ease;
    }
    .error-message.show { display: block; opacity: 1; }


    .form-modal {
      background: rgba(28, 28, 30, 0.95);
      border-radius: 16px;
      width: 90%;
      max-width: 450px;
      color: #fff;
      text-align: left;
      overflow: hidden;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.8), 0 0 0 1px rgba(255, 255, 255, 0.1);
      animation: modalFadeIn 0.3s ease;
      -webkit-backdrop-filter: blur(20px);
      backdrop-filter: blur(20px);
    }
    
    @keyframes modalFadeIn {
      from { opacity: 0; transform: scale(0.95); }
      to { opacity: 1; transform: scale(1); }
    }
    
    .form-modal-header {
      position: relative;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 16px 20px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .form-modal-header h3 {
      font-size: 20px;
      margin: 0;
      letter-spacing: 0.5px;
      font-weight: 600;
      text-align: center;
      width: 100%;
    }
    
    .form-modal-content {
      padding: 8px 0;
    }
    
    .form-item-container {
      display: flex;
      flex-direction: column;
    }
    
    .form-item {
      display: flex;
      align-items: center;
      padding: 16px 20px;
      cursor: pointer;
      transition: background-color 0.2s;
      position: relative;
    }
    
    .form-item:after {
      content: '';
      position: absolute;
      left: 20px;
      right: 20px;
      bottom: 0;
      height: 1px;
      background: rgba(255, 255, 255, 0.1);
    }
    
    .form-item:last-child:after {
      display: none;
    }
    
    .form-item:hover {
      background-color: rgba(255, 255, 255, 0.05);
    }
    
    .form-item:active {
      background-color: rgba(255, 255, 255, 0.1);
    }
    
    .form-icon {
      width: 42px;
      height: 42px;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 16px;
      background: linear-gradient(135deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05));
      box-shadow: 0 4px 8px rgba(0,0,0,0.15);
      flex-shrink: 0;
    }
    
    .form-icon .material-icons {
      font-size: 24px;
    }
    
    #overtimeForm .form-icon {
      color: #ff9800;
    }
    
    #cardCorrectionForm .form-icon {
      color: #03a9f4;
    }
    
    #leaveRequestForm .form-icon {
      color: #4caf50;
    }
    
    #shiftChangeForm .form-icon {
      color: #9c27b0;
    }
    
    /* æŸ¥è©¢ä»‹é¢çš„åœ–ç¤ºé¡è‰² */
    #cardCorrectionFormQuery .form-icon {
      color: #03a9f4;
    }
    
    #overtimeFormQuery .form-icon {
      color: #ff9800;
    }
    
    #leaveRequestFormQuery .form-icon {
      color: #4caf50;
    }
    
    #shiftChangeFormQuery .form-icon {
      color: #9c27b0;
    }
    
    /* æŸ¥è©¢é¡å‹é¸æ“‡ä»‹é¢çš„åœ–ç¤ºæ¨£å¼ */
    #btnAttendanceQuery .form-icon {
      color: #4caf50;  /* ç¶ è‰² - å‡ºå‹¤ç´€éŒ„ */
    }
    
    #btnFormQuery .form-icon {
      color: #3498db;  /* è—è‰² - è¡¨å–®ç´€éŒ„ */
    }
    
    .form-info {
      flex: 1;
    }
    
    .form-info h4 {
      font-size: 17px;
      margin: 0 0 4px 0;
      font-weight: 600;
    }
    
    .form-info p {
      font-size: 14px;
      margin: 0;
      color: #999;
    }
    
    .form-arrow {
      color: #777;
    }
    
    /* ç¶­ä¿®ä¸­ç‹€æ…‹æ¨£å¼ */
    .form-item.maintenance {
      background-color: rgba(128, 128, 128, 0.2);
      cursor: not-allowed;
      opacity: 0.6;
      position: relative;
    }
    
    .form-item.maintenance .form-icon {
      color: #888 !important;
      background: linear-gradient(135deg, rgba(128,128,128,0.1), rgba(128,128,128,0.05));
    }
    
    .form-item.maintenance .form-info h4 {
      color: #888;
    }
    
    .form-item.maintenance .form-info p {
      color: #666;
    }
    
    .form-item.maintenance .form-arrow {
      color: #666;
    }
    
    .form-item.maintenance:hover {
      background-color: rgba(128, 128, 128, 0.2);
    }
    
    .form-item.maintenance:after {
      display: none !important;
    }
    
    .form-item.maintenance::before {
      content: 'ç¶­ä¿®ä¸­';
      position: absolute;
      top: 50%;
      right: 15px;
      transform: translateY(-50%);
      background: #666;
      color: #fff;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: bold;
      z-index: 10;
    }
    
    .btn.disabled-button {
      opacity: 0.4;
      cursor: not-allowed;
      background: linear-gradient(to right, var(--btn-disabled-from), var(--btn-disabled-to)) !important;
    }
    
    .btn.disabled-button:hover {
      transform: none !important;
    }
    
    .btn.disabled-button:active {
      transform: none !important;
    }
    
    .overlay.show.form-overlay {
      -webkit-backdrop-filter: blur(5px);
      backdrop-filter: blur(5px);
    }
    
    @keyframes shimmer {
      0% { background-position: -1000px 0; }
      100% { background-position: 1000px 0; }
    }
    
    .skeleton-loader {
      background: linear-gradient(to right, #333 8%, #444 18%, #333 33%);
      background-size: 1000px 100%;
      animation: shimmer 2s infinite linear;
      border-radius: 4px;
    }
    
    .btn-cooldown {
      --progress: 0%;
      background-image: linear-gradient(to right, var(--color-from) 0%, var(--color-to) var(--progress), #666 var(--progress), #555 100%) !important;
      transition: --progress 0.3s linear;
    }
    
    .form-content {
      padding: 20px;
      max-height: 75vh;
      overflow-y: auto;
      overflow-x: hidden !important;
      max-width: 100% !important;
      scroll-behavior: smooth;
      -webkit-overflow-scrolling: touch;
    }

    .date-input-container,
    .time-input-container {
      display: flex;
      align-items: center;
      width: 100%;
    }
    
    .spacer-element {
      width: 60px;
      margin-left: 10px;
      visibility: hidden;
    }

    input[type="date"],
    input[type="time"],
    select,
    textarea {
      -webkit-appearance: none;
      -moz-appearance: none;
      appearance: none;
      display: block;
      width: 100%;
      font-size: 16px;
      padding: 12px;
      background-color: #333;
      color: #fff;
      border: 1px solid #555;
      border-radius: 5px;
    }

    input[type="date"]::-webkit-calendar-picker-indicator,
    input[type="time"]::-webkit-calendar-picker-indicator {
      filter: invert(1);
      opacity: 0.7;
    }

    .weekday-display {
      display: flex;
      align-items: center;
      justify-content: center;
      min-width: 60px;
      height: 42px;
      background-color: #444;
      color: #fff;
      border-radius: 5px;
      margin-left: 10px;
      font-weight: bold;
    }
    
    /* è¡¨å–®å…§å®¹æœ€å¾Œä¸€å€‹å­å…ƒç´ çš„åº•éƒ¨é–“è· */
    .form-content > *:last-child {
      margin-bottom: 5px !important;
    }

    .form-buttons-container {
      display: flex;
      padding: 12px 16px;
      gap: 8px;
      width: 100%;
      box-sizing: border-box;
      justify-content: space-between;
      background-color: transparent; /* é€æ˜èƒŒæ™¯ï¼Œå®Œå…¨ç¹¼æ‰¿çˆ¶å®¹å™¨é¡è‰² */
      border-radius: 8px;
      margin-top: 5px;  /* æ”¹ç‚º 5px */
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
      align-items: center;
      /* ç·Šæ¹Šå–®è¡Œè¨­è¨ˆ */
      min-height: 44px;
    }

    .form-buttons-container .btn {
      flex: 1;
      padding: 8px 8px;  /* æ¸›å°‘æ°´å¹³ padding å¾ 12px åˆ° 8px */
      border: none;
      border-radius: 6px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      box-shadow: 0 2px 4px rgba(0,0,0,0.3);
      transition: all 0.3s ease;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      min-height: 32px;
    }

    .btn-confirm:disabled {
      opacity: 0.8;
      background: #666;
      color: #eee;
    }

    /* ä¸Šå‚³æŒ‰éˆ•ç‰¹æ®Šæ¨£å¼ */
    .btn-upload {
      background-color: transparent !important;
      color: #f5a623 !important;
      border: 2px solid #f5a623 !important;
    }

    .btn-upload:hover {
      background-color: #f5a623 !important;
      color: #ffffff !important;
      transform: translateY(-1px);
    }

    .btn-upload:active {
      transform: translateY(0);
    }

    /* å‹•æ…‹æŒ‰éˆ•æ’åº */
    .form-buttons-container.two-buttons {
      justify-content: space-between;
    }
    
    /* å–®ä¸€æŒ‰éˆ•ç½®ä¸­é¡¯ç¤º */
    .form-buttons-container.one-button {
      justify-content: center;
    }
    
    .form-buttons-container.one-button .btn {
      max-width: 250px;
    }

    .form-buttons-container.three-buttons {
      justify-content: space-between;
    }

    .form-buttons-container.three-buttons .btn-cancel {
      order: 1; /* å–æ¶ˆæŒ‰éˆ•åœ¨å·¦ */
    }

    .form-buttons-container.three-buttons .btn-confirm {
      order: 2; /* æäº¤æŒ‰éˆ•åœ¨ä¸­ */
    }

    .form-buttons-container.three-buttons .btn-upload {
      order: 3; /* ä¸Šå‚³æŒ‰éˆ•åœ¨å³ */
    }

    /* ğŸ”§ ä¿®å¾©ï¼šå¹³å‡å¯¬åº¦åˆ†é… - ç¢ºä¿ä¸‰æŒ‰éˆ•ä¸æœƒæº¢å‡º */
    .form-buttons-container.three-buttons .btn-cancel {
      flex: 1 1 0; /* å¹³å‡åˆ†é… */
      min-width: 0; /* å…è¨±ç¸®å° */
    }

    .form-buttons-container.three-buttons .btn-confirm {
      flex: 1 1 0; /* å¹³å‡åˆ†é… */
      min-width: 0; /* å…è¨±ç¸®å° */
    }

    .form-buttons-container.three-buttons .btn-upload {
      flex: 1 1 0; /* å¹³å‡åˆ†é… */
      min-width: 0; /* å…è¨±ç¸®å° */
    }

    @media (max-width: 480px) {
      .form-modal {
        width: 95%;
      }
      
      .form-content {
        padding: 15px;
        max-height: 85vh;
      }
      
      .date-input-container,
      .time-input-container {
        flex-direction: row;
        align-items: center;
      }
      
      .weekday-display {
        min-width: 50px;
        height: 38px;
        font-size: 14px;
      }
      
      /* ğŸ”§ ä¿®å¾©ï¼šå°è¢å¹•ä¸‰æŒ‰éˆ•ä½ˆå±€å„ªåŒ– */
      .form-buttons-container.three-buttons {
        gap: 6px; /* ç¸®å°é–“è· */
      }
      
      .form-buttons-container.three-buttons .btn {
        padding: 8px 10px; /* ç¸®å°å…§é‚Šè· */
        font-size: 13px; /* ç¸®å°å­—é«” */
        gap: 4px; /* ç¸®å°åœ–æ¨™é–“è· */
      }
      
      /* å¹³å‡åˆ†é…å·²åœ¨ä¸Šæ–¹è¨­å®šï¼Œç„¡éœ€ç‰¹æ®Šè™•ç† */
    }

    .ui-datepicker {
      background: #333;
      color: #fff;
      border: 1px solid #555;
      box-shadow: 0 5px 15px rgba(0,0,0,0.5);
        padding: 10px;
      box-sizing: border-box;
    }
    
    .ui-datepicker .ui-datepicker-header {
      background: #444;
      color: #fff;
      border: none;
      border-radius: 3px;
    }
    
    .ui-datepicker .ui-datepicker-title {
      color: #fff;
    }
    
    .ui-datepicker .ui-datepicker-prev,
    .ui-datepicker .ui-datepicker-next {
      background: transparent;
      border: none;
      color: #fff;
    }
    
    .ui-datepicker th {
      color: #ccc;
    }
    
    .ui-datepicker td a {
      background: #444;
      color: #fff;
      border: none;
      text-align: center;
    }
    
    .ui-datepicker td a.ui-state-active {
      background: #3498db;
      color: #fff;
    }
    
    .ui-datepicker td a.ui-state-highlight {
      background: #555;
      color: #4CAF50;
    }
    
    .ui-timepicker-div {
      background: #333;
      color: #fff;
      background-color: #222;
      padding: 15px;
      border-radius: 0;
      border: none;
      border-top: 1px solid #444;
      box-shadow: none;
      }
    
    .ui-datepicker-buttonpane,
    .ui-timepicker-buttonpane {
      background: transparent;
      border: none;
    }
    
    .form-input,
    input.datepicker,
    input.timepicker {
      text-align: left;
      padding-left: 15px;
    }
    
    .form-input, .weekday-display, .date-input-container, .time-input-container, .radio-option {
      height: 42px;
      box-sizing: border-box;
    }
    
    .weekday-display {
      width: 60px;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    
    .ui-timepicker-div .ui_tpicker_time,
    .ui-timepicker-div .ui_tpicker_time_label,
    .ui-timepicker-div .ui_tpicker_hour_label,
    .ui-timepicker-div .ui_tpicker_minute_label {
      display: none;
    }
    
    .ui-timepicker-div dl {
      display: flex;
      flex-direction: row;
      justify-content: space-between;
      align-items: flex-start;
      margin: 0;
      padding: 0;
    }
    
    .radio-option {
      transition: background-color 0.2s, transform 0.1s;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 42px;
      box-sizing: border-box;
    }
    
    .radio-option:active {
      transform: scale(0.98);
    }
    
    .checkmark {
      transition: opacity 0.2s;
    }
    
    .ui-datepicker, .ui-timepicker-div {
      margin-top: 0;
    }
    
    .ui-slider {
      display: none;
    }
    
    .ui-timepicker-div dd {
      margin: 0;
      padding: 0;
      width: 48%;
      text-align: center;
    }
    
    .ui-timepicker-div dd.ui_tpicker_hour:before {
      content: 'å°æ™‚';
      display: block;
      margin-bottom: 5px;
      color: #ccc;
      font-size: 14px;
      text-align: center;
    }
    
    .ui-timepicker-div dd.ui_tpicker_minute:before {
      content: 'åˆ†é˜';
      display: block;
      margin-bottom: 5px;
      color: #ccc;
      font-size: 14px;
      text-align: center;
    }
    
    .ui-timepicker-div select {
      width: 95%;
      margin: 0 auto;
      text-align: center;
      text-align-last: center;
      -webkit-text-align-last: center;
      -moz-text-align-last: center;
    }
    
    .ui-timepicker-div select option {
      text-align: center;
    }
    
    .ui-timepicker-div .timepicker-buttons {
      display: flex;
      justify-content: space-between;
      margin-top: 15px;
      padding-top: 15px;
      border-top: 1px solid #444;
    }
    
    .ui-timepicker-div .timepicker-button {
      background-color: #333;
      color: #fff;
      border: 1px solid #555;
      border-radius: 5px;
      padding: 8px 15px;
      font-size: 14px;
      cursor: pointer;
      transition: background-color 0.2s;
      min-width: 80px;
      text-align: center;
    }
    
    .ui-timepicker-div .timepicker-button.confirm {
      background-color: #2c7a3e;
      border-color: #1e5a2d;
    }
    
    .ui-timepicker-div .timepicker-button.cancel {
      background-color: #666;
      border-color: #555;
    }
    
    .ui-timepicker-div .timepicker-button:hover {
      opacity: 0.9;
    }
    
    /* æ—¥æœŸè¼¸å…¥å®¹å™¨å¯¬åº¦èª¿æ•´ */
    .date-input-container {
      position: relative;
      width: calc(100% - 90px);
    }
    
    /* æ—¥æœŸè¼¸å…¥æ¡†å¯¬åº¦è¨­ç½® */
    .date-input-container input.datepicker {
      width: 100%;
    }
    
    /* æ˜ŸæœŸé¡¯ç¤ºä½ç½®èª¿æ•´ */
    .weekday-display {
      position: absolute;
      right: -90px;
      top: 0;
      height: 42px;
      width: 80px;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    
    /* è£œå……/å¼·åŒ–é¡å‹é¸é …å±…ä¸­ */
    .radio-option {
      display: flex;
      justify-content: center;
      align-items: center;
      text-align: center;
    }
    
    .radio-option .checkmark,
    .radio-option span {
      margin: 0;
      padding: 0;
    }
    
    .radio-option .checkmark {
      margin-right: 8px;
    }
    
    /* ç¢ºä¿æ—¥æœŸé¸æ“‡å™¨æ¨™é¡Œå’Œè¡¨æ ¼æ­£ç¢ºé¡¯ç¤º */
    .ui-datepicker .ui-datepicker-header {
      background: #444;
      border: none;
      border-radius: 4px;
      padding: 8px;
      font-size: 16px;
    }
    
    .ui-datepicker table {
      margin: 10px 0;
      width: 100%;
      border-collapse: separate;
      border-spacing: 2px;
    }
    
    .ui-datepicker th {
      padding: 8px 0;
      font-size: 14px;
    }
    
    .ui-datepicker td {
      padding: 2px;
      height: 36px;
    }
    
    .ui-datepicker td a {
      text-align: center;
      padding: 8px 0;
      height: 32px;
      line-height: 16px;
      border-radius: 4px;
      font-size: 15px;
    }
    
    /* SVGé¸é …æ¨£å¼ */
    .svg-option {
      overflow: hidden;
    }
    
    .svg-option svg {
      display: block;
    }
    
    .svg-option svg text {
      font-family: 'Roboto Mono', monospace;
    }

/* è¡¨å–®éŒ¯èª¤å®¹å™¨ */
    .form-error-container {
      color: #ff4444;
      font-size: 14px;
      margin-top: 15px;
      padding: 10px;
      border-radius: 5px;
      background-color: rgba(255, 68, 68, 0.1);
      display: none;
      text-align: center !important;
    }
    
    /* è¼¸å…¥éŒ¯èª¤è¨Šæ¯ */
    .input-error, .textarea-error {
      color: #ff4444;
      font-size: 12px;
      margin-top: 5px;
      display: none;
    }
    
    /* æ»¾å‹•åˆ°é ‚éƒ¨æŒ‰éˆ• */
    .scroll-top-button {
      position: fixed;
      right: 20px;
      bottom: 90px;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background-color: rgba(52, 152, 219, 0.7);
      color: #fff;
      border: none;
      display: none;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      z-index: 9999;
    }

    /* ç¦æ­¢è¡¨å–®å·¦å³æ»‘å‹• */
    .form-content {
      overflow-x: hidden !important;
      max-width: 100% !important;
    }
    
    /* ç¢ºä¿è¡¨å–®å®¹å™¨ä¸è¶…å‡ºé‚Šç•Œ */
    .form-modal {
      overflow-x: hidden !important;
      max-width: 100% !important;
    }
    
    .form-group,
    .form-input,
    .form-textarea,
    .date-input-container,
    .time-input-container,
    .radio-container,
    .form-error-container {
      max-width: 100% !important;
      box-sizing: border-box !important;
    }
    
    /* å¿…å¡«æ¨™è¨˜æ¨£å¼ */
    .required-mark {
      color: #ff4444;
      font-size: 16px;
      margin-left: 5px;
      font-weight: normal;
      white-space: nowrap;
      font-family: 'Material Icons';
      vertical-align: middle;
    }
    
    /* ç¦æ­¢è¡¨å–®å·¦å³æ»‘å‹•çš„æ¨£å¼ - æ˜ŸæœŸé¡¯ç¤ºä¿®å¾©ç‰ˆ */
    /* ç¦æ­¢è¡¨å–®å…§å®¹å·¦å³æ»‘å‹• */
    .form-content {
      overflow-x: hidden !important;
    }
    
    /* ç¢ºä¿è¡¨å–®å®¹å™¨ä¸è¶…å‡ºé‚Šç•Œï¼Œä½†ä¿ç•™è¶³å¤ ç©ºé–“çµ¦æ˜ŸæœŸé¡¯ç¤º */
    .form-modal {
      overflow-x: hidden !important;
      max-width: 450px !important;
      width: 90% !important;
    }
    
    /* ä¿®æ”¹å…§éƒ¨å…ƒç´ ç¢ºä¿ä¸è¶…å‡ºå®¹å™¨ä½†ä¿ç•™æ˜ŸæœŸé¡¯ç¤ºæ‰€éœ€ç©ºé–“ */
    .form-group,
    .form-input,
    .form-textarea,
    .radio-container,
    .form-error-container {
      max-width: 100% !important;
      box-sizing: border-box !important;
    }
    
    /* ç¢ºä¿æ—¥æœŸè¼¸å…¥å®¹å™¨æœ‰è¶³å¤ ç©ºé–“å®¹ç´æ˜ŸæœŸé¡¯ç¤º */
    .date-input-container {
      position: relative !important;
      width: calc(100% - 90px) !important;
      max-width: calc(100% - 90px) !important;
      box-sizing: border-box !important;
      margin-right: 90px !important; /* ç‚ºæ˜ŸæœŸé¡¯ç¤ºé ç•™ç©ºé–“ */
    }
    
    /* ç¢ºä¿æ˜ŸæœŸé¡¯ç¤ºå…ƒç´ å§‹çµ‚å¯è¦‹ */
    .weekday-display {
      position: absolute !important;
      right: -90px !important;
      top: 0 !important;
      height: 42px !important;
      width: 80px !important;
      display: flex !important;
      justify-content: center !important;
      align-items: center !important;
      visibility: visible !important;
      z-index: 10 !important; /* ç¢ºä¿é¡¯ç¤ºå±¤ç´šé«˜æ–¼å…¶ä»–å…ƒç´  */
    }
    
    /* æ™‚é–“è¼¸å…¥å®¹å™¨ç‰¹åˆ¥è™•ç† */
    .time-input-container {
      max-width: 100% !important;
      box-sizing: border-box !important;
    }
    
    .form-error-container {
      text-align: center !important;
    }
    
    /* å¢å¼·è·¨å¹³å°éŸ¿æ‡‰å¼è¨­è¨ˆ */
    @media (max-width: 480px) {
      .form-modal {
        width: 95% !important;
        max-width: 95% !important;
      }
      
      /* ç§»å‹•è¨­å‚™ä¸Šèª¿æ•´æ˜ŸæœŸé¡¯ç¤ºå°ºå¯¸ */
      .weekday-display {
        width: 70px !important;
        right: -80px !important;
        font-size: 14px !important;
      }
    }
    
    /* æª”æ¡ˆä¸Šå‚³æç¤ºæ¨£å¼ */
    .file-upload-note {
      margin-top: 15px;
      padding: 10px;
      background-color: rgba(52, 152, 219, 0.1);
      border-radius: 5px;
      border-left: 3px solid #3498db;
      color: #3498db;
      font-size: 12px;
      text-align: center;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* ä½è­‰æ–‡ä»¶æç¤ºæ¨£å¼ - æ©™è‰²èƒŒæ™¯ */
    .file-requirement-hint {
      background: rgba(255, 152, 0, 0.1) !important;
      border: 1px solid #ff9800 !important;
      border-radius: 8px !important;
      padding: 12px 16px !important;
      margin-bottom: 15px !important;
      text-align: center !important;
      color: #ff9800 !important;
      font-weight: 500 !important;
      font-size: 16px !important;
    }

    /* è¡Œå…§éŒ¯èª¤æç¤ºæ¨£å¼ */
    .form-group .error-inline {
      display: none;
      color: #ff4444;
      font-size: 12px;
      margin-top: 5px;
      align-items: center;
      gap: 5px;
    }

    .form-group.has-error .error-inline {
      display: flex;
      animation: slideDown 0.3s ease-out;
    }

    .form-group.has-error input,
    .form-group.has-error select,
    .form-group.has-error textarea {
      border-color: #ff4444 !important;
      background-color: rgba(255, 68, 68, 0.05);
    }

    @keyframes slideDown {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .file-upload-note .material-icons {
      margin-right: 8px;
      font-size: 18px;
    }

    /* é™°å½±ç«‹é«”é¢¨æ ¼æŒ‰éˆ•æ¨£å¼ */
    .back-button-shadow {
      position: absolute;
      left: 15px;
      background-color: #3a3a3a;
      border: none;
      color: white;
      padding: 6px 12px;
      display: flex;
      align-items: center;
      border-radius: 8px;
      cursor: pointer;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3), 
                  inset 0 1px 0 rgba(255, 255, 255, 0.15);
      transition: all 0.2s;
    }
    
    .back-button-shadow .material-icons {
      font-size: 20px;
      margin-right: 6px;
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.4);
    }
    
    .back-button-shadow .back-text {
      font-size: 14px;
      font-weight: 500;
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
    }
    
    .back-button-shadow:hover {
      background-color: #454545;
      transform: translateY(-1px);
      box-shadow: 0 3px 7px rgba(0, 0, 0, 0.4), 
                  inset 0 1px 0 rgba(255, 255, 255, 0.2);
    }
    
    .back-button-shadow:active {
      background-color: #333333;
      transform: translateY(1px);
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3), 
                  inset 0 1px 2px rgba(0, 0, 0, 0.3);
    }
    
    /* éŸ¿æ‡‰å¼è¨­è¨ˆ */
    @media (max-width: 480px) {
      .back-button-shadow {
        padding: 4px 10px;
      }
      
      .back-button-shadow .material-icons {
        font-size: 18px;
        margin-right: 4px;
      }
      
      .back-button-shadow .back-text {
        font-size: 12px;
      }
    }

    /* V3 æŸ¥è©¢è¨˜éŒ„è¡¨æ ¼æ¨£å¼ */
    .record-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      font-size: 15px;
      color: #fff;
    }
    .record-table th, .record-table td {
      border: 1px solid #555;
      padding: 10px 8px;
      text-align: center;
      word-wrap: break-word; /* é¿å…æ–‡å­—éé•·æ›è¡Œ */
    }
    .record-table th {
      background-color: #444;
      font-weight: bold;
    }
    .record-table tbody tr:nth-child(odd) {
      background-color: #2c2c2c;
    }
    .record-table .time-in {
      color: #2ecc71; /* ç¶ è‰² */
      font-weight: bold;
    }
    .record-table .time-out {
      color: #e74c3c; /* ç´…è‰² */
      font-weight: bold;
    }
    .info-message {
      text-align: center;
      color: #999;
      margin-top: 20px;
      font-size: 16px;
    }
  </style>

<body>
  <div id="networkStatus" class="network-status network-good">
    <span class="material-icons">wifi</span>
    <span class="status-text">è‰¯å¥½</span>
  </div>
  <div id="helpSupport" class="help-status">
    <a href="https://line.me/R/ti/p/@934pxusr" target="_blank">
      <span class="material-icons">smart_toy</span>
      <span>AI Bot</span>
    </a>
  </div>
  <div class="container">
    <img class="logo" src="https://i.imgur.com/YHBBnuO.jpeg" alt="Logo" crossorigin="anonymous">
    <h1>SC_Office_ANN</h1>
    <h2>è«‹éµå…¥èº«åˆ†è­‰å¾Œå››ç¢¼åŸ·è¡Œæ‰“å¡</h2>

    <form id="idForm">
      <label for="idCode">è«‹é»æ“Šä¸‹æ–¹æ¡†å…§éµå…¥å¾Œå››ç¢¼</label>
      <div class="input-group">
        <input 
          type="password" 
          id="idCode" 
          name="idCode" 
          required 
          pattern="\d{4}" 
          maxlength="4" 
          inputmode="numeric"
          autocomplete="off" 
          autocorrect="off" 
          autocapitalize="off" 
          spellcheck="false"
        />
        <button type="button" class="toggle-btn" id="toggleBtn" aria-label="åˆ‡æ›å¯†ç¢¼é¡¯ç¤º">
          <span class="material-icons" id="eyeIcon">visibility</span>
        </button>
        <span class="error-message"></span>
      </div>
    </form>
    <div class="btn-group">
      <!-- ç¬¬ä¸€è¡Œï¼šä¸Šç­ã€ä¸‹ç­ã€å„é …è¡¨å–® -->
      <button type="button" class="btn btn-on" id="btnOn" data-original-text="ä¸Šç­" disabled>ä¸Šç­</button>
      <button type="button" class="btn btn-off" id="btnOff" data-original-text="ä¸‹ç­" disabled>ä¸‹ç­</button>
      <button type="button" class="btn btn-form" id="btnForm" data-original-text="å„é …è¡¨å–®" disabled>å„é …è¡¨å–®</button>
      <!-- ç¬¬äºŒè¡Œï¼šæŸ¥è©¢ç´€éŒ„ã€æŸ¥é–±ç­è¡¨ã€æŸ¥é–±å…¬å‘Š -->
      <button type="button" class="btn btn-query" id="btnQuery" data-original-text="æŸ¥è©¢ç´€éŒ„" disabled>æŸ¥è©¢ç´€éŒ„</button>
      <button type="button" class="btn btn-schedule" id="btnSchedule" data-original-text="æŸ¥é–±ç­è¡¨" disabled>æŸ¥é–±ç­è¡¨</button>
      <button type="button" class="btn btn-notice" id="btnNotice" data-original-text="æŸ¥é–±å…¬å‘Š" disabled>æŸ¥é–±å…¬å‘Š</button>
      <!-- ç¬¬ä¸‰è¡Œï¼šä¸»ç®¡é™å®šã€å€‹äººè³‡è¨Šã€æ¸¬è©¦å®šä½ -->
      <button type="button" class="btn btn-manager disabled-button" id="btnManager" data-original-text="ä¸»ç®¡é™å®š" disabled>ä¸»ç®¡é™å®š</button>
      <button type="button" class="btn btn-personal disabled-button" id="btnPersonal" data-original-text="Dutyæ—¥èªŒ" disabled>Dutyæ—¥èªŒ</button>
      <button type="button" class="btn btn-test" id="btnTest" data-original-text="æ¸¬è©¦å®šä½" disabled>æ¸¬è©¦å®šä½</button>
    </div>
    <div id="response" role="status" aria-live="polite"></div>
  </div>
  
  <div id="overlay" class="overlay">
    <div class="modal">
      <h3 id="modal-title">æç¤º</h3>
      <p id="modal-message">æç¤ºè¨Šæ¯</p>
      <div class="modal-buttons">
        <button id="modal-confirm" class="btn btn-confirm">ç¢ºå®š</button>
        <button id="modal-cancel" class="btn btn-cancel">å–æ¶ˆ</button>
      </div>
    </div>
  </div>
  
  <div id="incognitoPrompt">
    <div class="prompt-content">
      <h2>ç³»çµ±æç¤º</h2>
      <p>è«‹ç¢ºä¿é—œé–‰ç„¡ç—•ç€è¦½å™¨æ¨¡å¼å¾Œå†åŸ·è¡Œ</p>
      <div class="button-group">
        <button id="confirmIncognito">æˆ‘å·²ç¢ºèªé—œé–‰</button>
        <button id="cancelIncognito">å–æ¶ˆ</button>
      </div>
    </div>
  </div>
  
  <!-- â˜… æ–¹æ¡ˆ 1ï¼šè¶…ç‹ ç«‹å³è™•ç†è…³æœ¬ -->
  <script>
  (function() {
    'use strict';
    
    console.log('âš¡ æ–¹æ¡ˆ 1 å•Ÿå‹•ï¼šHTML å…§åµŒç«‹å³è™•ç†');
    
    // ç«‹å³é¡¯ç¤ºæç¤ºæ¡†ï¼ˆä¸ç­‰å¾…ä»»ä½•è¼‰å…¥ï¼‰
    const prompt = document.getElementById('incognitoPrompt');
    if (prompt) {
      prompt.style.display = 'flex';
      console.log('âœ“ ç„¡ç—•æç¤ºæ¡†å·²ç«‹å³é¡¯ç¤º');
    }
    
    // ä½¿ç”¨äº‹ä»¶å§”æ´¾ç¢ºä¿é»æ“Šäº‹ä»¶ä¸€å®šæœ‰æ•ˆ
    document.addEventListener('click', function(e) {
      // è™•ç†ç¢ºèªæŒ‰éˆ•
      if (e.target && e.target.id === 'confirmIncognito') {
        const prompt = document.getElementById('incognitoPrompt');
        if (prompt) {
          prompt.style.display = 'none';
          console.log('âœ“ ç„¡ç—•æç¤ºå·²é—œé–‰ï¼ˆHTMLå…§åµŒè™•ç†ï¼‰');
          
          // å¯é¸ï¼šè§¸ç™¼è‡ªå®šç¾©äº‹ä»¶é€šçŸ¥ä¸»ç³»çµ±
          window.dispatchEvent(new CustomEvent('incognitoPromptClosed', {
            detail: { method: 'html-inline', timestamp: Date.now() }
          }));
        }
        e.preventDefault();
        e.stopPropagation();
      }
      
      // è™•ç†å–æ¶ˆæŒ‰éˆ•
      if (e.target && e.target.id === 'cancelIncognito') {
        alert('å·²å–æ¶ˆï½œç„¡æ³•ä½¿ç”¨ç³»çµ±');
        window.location.href = 'about:blank';
        e.preventDefault();
        e.stopPropagation();
      }
    });
    
    // å¯é¸ï¼šéµç›¤æ”¯æ´ï¼ˆESC éµé—œé–‰ï¼‰
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape' || e.keyCode === 27) {
        const prompt = document.getElementById('incognitoPrompt');
        if (prompt && prompt.style.display !== 'none') {
          prompt.style.display = 'none';
          console.log('âœ“ ç„¡ç—•æç¤ºå·²é—œé–‰ï¼ˆESCéµï¼‰');
        }
      }
    });
    
    console.log('âš¡ æ–¹æ¡ˆ 1 è¨­ç½®å®Œæˆï¼šç„¡ç—•æç¤ºå¯ç«‹å³æ“ä½œï¼ˆ0å»¶é²ï¼‰');
  })();
  </script>
  
  <div id="videoTutorialModal" class="video-modal">
    <div class="video-content">
      <button class="close-btn" id="closeVideoModal">Ã—</button>
      <video id="tutorialVideo" controls>
        <source src="https://i.imgur.com/Wnemzxu.mp4" type="video/mp4">
        æ‚¨çš„ç€è¦½å™¨ä¸æ”¯æ´å½±ç‰‡æ’­æ”¾ï¼Œè«‹é»æ­¤è§€çœ‹ï¼š
        <a href="https://i.imgur.com/Wnemzxu.mp4" target="_blank">https://i.imgur.com/Wnemzxu.mp4</a>
      </video>
      <div class="fallback-link" id="videoFallback">
        <a href="https://i.imgur.com/Wnemzxu.mp4" target="_blank">ç„¡æ³•æ’­æ”¾å½±ç‰‡ï¼Ÿè«‹é»æ­¤è§€çœ‹</a>
      </div>
    </div>
  </div>
  
  <div id="formApplicationModal" class="overlay">
    <div class="form-modal">
      <div class="form-modal-header">
        <h3>å„é …è¡¨å–®</h3>
      </div>
      <div class="form-modal-content">
        <div class="form-item-container">
          <!-- è£œå¡ç”³è«‹ -->
          <div class="form-item" id="cardCorrectionForm">
            <div class="form-icon">
              <span class="material-icons">credit_card</span>
            </div>
            <div class="form-info">
              <h4>è£œå¡ç”³è«‹</h4>
              <p>å¿˜è¨˜æ‰“å¡æˆ–æ‰“å¡éŒ¯èª¤</p>
            </div>
            <div class="form-arrow">
              <span class="material-icons">chevron_right</span>
            </div>
          </div>
          
          <!-- åŠ ç­ç”³è«‹ -->
          <div class="form-item" id="overtimeForm">
            <div class="form-icon">
              <span class="material-icons">schedule</span>
            </div>
            <div class="form-info">
              <h4>åŠ ç­ç”³è«‹</h4>
              <p>æäº¤åŠ ç­æ™‚æ•¸åŠåŸå› </p>
            </div>
            <div class="form-arrow">
              <span class="material-icons">chevron_right</span>
            </div>
          </div>
          
          <!-- è«‹å‡ç”³è«‹ -->
          <div class="form-item" id="leaveRequestForm">
            <div class="form-icon">
              <span class="material-icons">event_busy</span>
            </div>
            <div class="form-info">
              <h4>è«‹å‡ç”³è«‹</h4>
              <p>è«‹å‡æ—¥æœŸåŠå‡åˆ¥é¸æ“‡</p>
            </div>
            <div class="form-arrow">
              <span class="material-icons">chevron_right</span>
            </div>
          </div>
          
          <!-- ç•°å‹•ç­åˆ¥ -->
          <div class="form-item maintenance" id="shiftChangeForm">
            <div class="form-icon">
              <span class="material-icons">compare_arrows</span>
            </div>
            <div class="form-info">
              <h4>ç•°å‹•ç­åˆ¥</h4>
              <p>è®Šæ›´æ’ç­ç­åˆ¥</p>
            </div>
            <div class="form-arrow">
              <span class="material-icons">chevron_right</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

<script src="ui.js" defer></script>
<script src="form-handler.ui.js" defer></script>
<script src="main.js" defer></script>
</body>
</html>
